!function(r,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((r=r||self).Points={})}(this,function(r){"use strict";function s(u){for(var r=1;r<arguments.length;r++)if(r%2){var c=null!=arguments[r]?arguments[r]:{},e=Object.keys(c);"function"==typeof Object.getOwnPropertySymbols&&(e=e.concat(Object.getOwnPropertySymbols(c).filter(function(r){return Object.getOwnPropertyDescriptor(c,r).enumerable}))),e.forEach(function(r){var e,t,n;e=u,n=c[t=r],t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n})}else Object.defineProperties(u,Object.getOwnPropertyDescriptors(arguments[r]));return u}function l(r,e){return function(r){if(Array.isArray(r))return r}(r)||function(r,e){var t=[],n=!0,u=!1,c=void 0;try{for(var o,a=r[Symbol.iterator]();!(n=(o=a.next()).done)&&(t.push(o.value),!e||t.length!==e);n=!0);}catch(r){u=!0,c=r}finally{try{n||null==a.return||a.return()}finally{if(u)throw c}}return t}(r,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function x(r){return function(r){if(Array.isArray(r)){for(var e=0,t=new Array(r.length);e<r.length;e++)t[e]=r[e];return t}}(r)||function(r){if(Symbol.iterator in Object(r)||"[object Arguments]"===Object.prototype.toString.call(r))return Array.from(r)}(r)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function k(r,e,t,n,u,c,o){var a=r.x,i=r.y;return{x:n*(a*=e)-u*(i*=t)+c,y:u*a+n*i+o}}function N(r,e,t,n){var u=r*t+e*n;return 1<u&&(u=1),u<-1&&(u=-1),(r*n-e*t<0?-1:1)*Math.acos(u)}function h(r){var e=r.px,t=r.py,n=r.cx,u=r.cy,i=r.rx,y=r.ry,c=r.xAxisRotation,o=void 0===c?0:c,a=r.largeArcFlag,v=void 0===a?0:a,f=r.sweepFlag,x=void 0===f?0:f,p=[];if(0===i||0===y)return[];var s=Math.sin(o*_/360),l=Math.cos(o*_/360),h=l*(e-n)/2+s*(t-u)/2,b=-s*(e-n)/2+l*(t-u)/2;if(0==h&&0==b)return[];i=Math.abs(i),y=Math.abs(y);var g=Math.pow(h,2)/Math.pow(i,2)+Math.pow(b,2)/Math.pow(y,2);1<g&&(i*=Math.sqrt(g),y*=Math.sqrt(g));var m=function(r,e,t,n,u,c,o,a,i,y,v,f){var x=Math.pow(u,2),p=Math.pow(c,2),s=Math.pow(v,2),l=Math.pow(f,2),h=x*p-x*l-p*s;h<0&&(h=0),h/=x*l+p*s;var b=(h=Math.sqrt(h)*(o===a?-1:1))*u/c*f,g=h*-c/u*v,m=y*b-i*g+(r+t)/2,d=i*b+y*g+(e+n)/2,M=(v-b)/u,w=(f-g)/c,A=(-v-b)/u,I=(-f-g)/c,O=N(1,0,M,w),j=N(M,w,A,I);return 0===a&&0<j&&(j-=_),1===a&&j<0&&(j+=_),[m,d,O,j]}(e,t,n,u,i,y,v,x,s,l,h,b),d=D(m,4),M=d[0],w=d[1],A=d[2],I=d[3],O=Math.abs(I)/(_/4);Math.abs(1-O)<1e-7&&(O=1);var j,P,T,S,q,E,L,F=Math.max(Math.ceil(O),1);I/=F;for(var R=0;R<F;R++)p.push((j=A,void 0,T=1.5707963267948966===(P=I)?.551915024494:-1.5707963267948966===P?-.551915024494:4/3*Math.tan(P/4),S=Math.cos(j),q=Math.sin(j),E=Math.cos(j+P),L=Math.sin(j+P),[{x:S-q*T,y:q+S*T},{x:E+L*T,y:L-E*T},{x:E,y:L}])),A+=I;return p.map(function(r){var e=k(r[0],i,y,l,s,M,w),t=e.x,n=e.y,u=k(r[1],i,y,l,s,M,w),c=u.x,o=u.y,a=k(r[2],i,y,l,s,M,w);return{x1:t,y1:n,x2:c,y2:o,x:a.x,y:a.y}})}function p(r,e,t){return Math.acos((Math.pow(r,2)+Math.pow(e,2)-Math.pow(t,2))/(2*r*e))*(180/Math.PI)}function b(e,r){for(var t=arguments.length,n=new Array(2<t?t-2:0),u=2;u<t;u++)n[u-2]=arguments[u];return i(r)?r.map(function(r){return e.apply(void 0,[r].concat(n))}):e.apply(void 0,[r].concat(n))}function g(r,e,t,n){return Math.sqrt(Math.pow(r-t,2)+Math.pow(e-n,2))}function m(r,e,t){var n=r===e?0:Math.abs(e-r);return 0===n?r:r<e?r+n*t:r-n*t}function e(r){for(var a=[],e=0,t=r.length;e<t;e++){var n=r[e];if(n.curve&&"cubic"!==n.curve.type){var u=r[e-1],c=u.x,o=u.y,i=n.x,y=n.y;if("arc"===n.curve.type)h({px:c,py:o,cx:i,cy:y,rx:n.curve.rx,ry:n.curve.ry,xAxisRotation:n.curve.xAxisRotation,largeArcFlag:n.curve.largeArcFlag,sweepFlag:n.curve.sweepFlag}).forEach(function(r){var e=r.x1,t=r.y1,n=r.x2,u=r.y2,c=r.x,o=r.y;a.push({x:c,y:o,curve:{type:"cubic",x1:e,y1:t,x2:n,y2:u}})});else if("quadratic"===n.curve.type){var v=c+2/3*(n.curve.x1-c),f=o+2/3*(n.curve.y1-o),x=i+2/3*(n.curve.x1-i),p=y+2/3*(n.curve.y1-y);a.push({x:i,y:y,curve:{type:"cubic",x1:v,y1:f,x2:x,y2:p}})}}else a.push(n)}return a}function t(r){return b(e,r)}function d(r,e){var t=e.curve,n=t.x1,u=t.y1,c=t.x2,o=t.y2,a={x:r.x,y:r.y},i={x:n,y:u},y={x:c,y:o},v={x:e.x,y:e.y},f={x:m(a.x,i.x,.5),y:m(a.y,i.y,.5)},x={x:m(i.x,y.x,.5),y:m(i.y,y.y,.5)},p={x:m(y.x,v.x,.5),y:m(y.y,v.y,.5)},s={x:m(f.x,x.x,.5),y:m(f.y,x.y,.5)},l={x:m(x.x,p.x,.5),y:m(x.y,p.y,.5)},h={x:m(s.x,l.x,.5),y:m(s.y,l.y,.5)};return[{x:h.x,y:h.y,curve:{type:"cubic",x1:f.x,y1:f.y,x2:s.x,y2:s.y}},{x:v.x,y:v.y,curve:{type:"cubic",x1:l.x,y1:l.y,x2:p.x,y2:p.y}}]}function v(r,e){return e.curve?d(r,e):function(r,e){return[{x:m(r.x,e.x,.5),y:m(r.y,e.y,.5)},e]}(r,e)}function M(r){var e=l(r[0],2),t=e[0],n=e[1],u=l(r[1],2),c=u[0],o=u[1],a=l(r[2],2),i=a[0],y=a[1],v=g(t,n,c,o),f=g(c,o,i,y),x=g(i,y,t,n);return p(v,f,x)}function w(r,e){var n=1<arguments.length&&void 0!==e?e:1;if(!function(r){return r.reduce(function(r,e){return!!e.curve||r},!1)}(r))return r;var u=t(r),c=[];return u.map(function(r,e){if(r.curve){var t=u[e-1];t.x===r.x&&t.y===r.y||y(t,r,n).map(function(r){return c.push(r)})}else c.push(r)}),c}function A(r){var n,u,c,o;return function(r){return i(r)?r:[r]}(r).map(function(r){return w(r).map(function(r){var e=r.x,t=r.y;("number"!=typeof n||n<t)&&(n=t),("number"!=typeof u||e<u)&&(u=e),("number"!=typeof c||c<e)&&(c=e),("number"!=typeof o||t<o)&&(o=t)})}),{bottom:n,center:{x:u+(c-u)/2,y:o+(n-o)/2},left:u,right:c,top:o}}function I(r,e){var i=w(r,e);return i.reduce(function(r,e,t){var n=e.x,u=e.y;if(!e.moveTo){var c=i[t-1],o=c.x,a=c.y;r+=g(o,a,n,u)}return r},0)}function n(r,t,n){return r.map(function(r){var e=s({},r);return e.x+=t,e.y+=n,e.curve&&(e.curve=s({},e.curve),"quadratic"!==e.curve.type&&"cubic"!==e.curve.type||(e.curve.x1+=t,e.curve.y1+=n),"cubic"===e.curve.type&&(e.curve.x2+=t,e.curve.y2+=n)),e})}function a(r,e,t){if(e.curve||t.curve)return!1;var n=(t.y-r.y)*(e.x-r.x)-(t.x-r.x)*(e.y-r.y);if(Math.abs(n)>Number.EPSILON)return!1;var u=(t.x-r.x)*(e.x-r.x)+(t.y-r.y)*(e.y-r.y);return!(u<0)&&!((e.x-r.x)*(e.x-r.x)+(e.y-r.y)*(e.y-r.y)<u)}function u(r){for(var e=[],t=0,n=r.length;t<n;t++){var u=e[e.length-1],c=r[t+1],o=r[t];u&&c&&o&&a(u,c,o)||e.push(o)}return e}function c(r){var x,p;return r.reverse().map(function(r,e){var t=r.x,n=r.y,u=r.moveTo,c=r.curve,o={x:t,y:n};if(p){var a=p,i=a.x1,y=a.y1,v=a.x2,f=a.y2;o.curve={type:"cubic",x1:v,y1:f,x2:i,y2:y}}return 0!==e&&!x||(o.moveTo=!0),x=u,p=c||null,o})}function O(r,e,t,n,u){var c=u.x,o=u.y,a=r-c,i=e-o;return[a*t-i*n+c,a*n+i*t+o]}function o(r,x,p){return r.map(function(r){var e=x*Math.PI/180,t=Math.cos(e),n=Math.sin(e),u=l(O(r.x,r.y,t,n,p),2),c=s({},r,{x:u[0],y:u[1]});if(c.curve){if("quadratic"===c.curve.type||"cubic"===c.curve.type){var o=l(O(c.curve.x1,c.curve.y1,t,n,p),2),a=o[0],i=o[1];c.curve=s({},c.curve,{x1:a,y1:i})}if("cubic"===c.curve.type){var y=l(O(c.curve.x2,c.curve.y2,t,n,p),2),v=y[0],f=y[1];c.curve=s({},c.curve,{x2:v,y2:f})}}return c})}var D=function(r,e){if(Array.isArray(r))return r;if(Symbol.iterator in Object(r))return function(r,e){var t=[],n=!0,u=!1,c=void 0;try{for(var o,a=r[Symbol.iterator]();!(n=(o=a.next()).done)&&(t.push(o.value),!e||t.length!==e);n=!0);}catch(r){u=!0,c=r}finally{try{!n&&a.return&&a.return()}finally{if(u)throw c}}return t}(r,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},_=2*Math.PI,i=function(r){return Array.isArray(r[0])},y=function r(e,t,n){var u=e.x,c=e.y,o=t.x,a=t.y,i=t.curve;if(function(r,e,t,n,u,c,o,a,i){var y=[[o,a],[r,e],[u,c]];return M([[t,n],[u,c],[r,e]])<i&&M(y)<i}(u,c,i.x1,i.y1,o,a,i.x2,i.y2,n))return[t];var y=l(d(e,t),2),v=y[0],f=y[1];return[].concat(x(r(e,v,n)),x(r(v,f,n)))},f=function(r){return r.length-(j(r)?1:0)},j=function(r){var e=r[0],t=r[r.length-1];return e.x===t.x&&e.y===t.y},P=function(r,e){var t=E(r),n=function(r){return r.reduce(function(r,e){return r+f(e)},0)}(t),u=(e%n+n)%n;if(!u)return r;var c=T(t,u),o=c.lineIndex,a=c.pointIndex,i=S(t,o),y=q(i[0],a),v=x(i).splice(1);return function(r){return r.reduce(function(r,e){return[].concat(x(r),x(e))},[])}([y].concat(x(v)))},T=function(r,e){for(var t=0,n=r.length;t<n;t++){var u=f(r[t]);if(e<=u-1)return{lineIndex:t,pointIndex:e};e-=u}},S=function(r,e){return x(r).splice(e).concat(x(r).splice(0,e))},q=function(r,e){if(!e)return r;var t=[{x:r[e].x,y:r[e].y,moveTo:!0}].concat(x(x(r).splice(e+1)));return j(r)?[].concat(x(t),x(x(r).splice(1,e))):[].concat(x(t),x(x(r).splice(0,e+1)))},E=function(r){return r.reduce(function(r,e){return e.moveTo&&r.push([]),r[r.length-1].push(e),r},[])},L=function(r,e){var t=r[0],n=t.x,u=t.y,c=r[1],o=c.x,a=c.y,i=g(n,u,o,a);return{x1:n,y1:u,x2:o,y2:a,segmentInterval:e/i,segmentLength:i}},F=function(r,e,t){for(var n=0,u=0;u<e;u++){if(!r[u].moveTo){var c=r[u-1],o=c.x,a=c.y,i=r[u],y=i.x,v=i.y,f=g(o,a,y,v);if(t<=n+f)return{x1:o,y1:a,x2:y,y2:v,segmentInterval:(t-n)/f,segmentLength:f};n+=f}}};r.add=function(r,e){return function r(e,t){if(isNaN(t))throw Error("`add` function must be passed a number as the second argument");for(var n=x(e),u=1;u<n.length;){if(n.length>=t)return n;var c=n[u];if(c.moveTo)u++;else{var o=n[u-1],a=l(v(o,c),2),i=a[0],y=a[1];n.splice(u,1,i,y),u+=2}}return r(n,t)}(t(r),e)},r.boundingBox=A,r.cubify=t,r.length=I,r.moveIndex=function(r,e){return b(P,r,e)},r.offset=function(r,e,t){return b(n,r,1<arguments.length&&void 0!==e?e:0,2<arguments.length&&void 0!==t?t:0)},r.position=function(r,e,t){var n=w(r,t),u=n.length,c=I(n),o=c*e,a=1<e?function(r,e,t,n){var u=r[e-2],c=u.x,o=u.y,a=r[e-1],i=a.x,y=a.y,v=g(c,o,i,y);return{x1:c,y1:o,x2:i,y2:y,segmentInterval:(n-t)/v+1,segmentLength:v}}(n,u,c,o):e<0?L(n,o):F(n,u,o),i=a.x1,y=a.y1,v=a.x2,f=a.y2,x=a.segmentInterval;return{angle:function(r,e,t,n,u){if(r===t)return n<=e?0:180;var c=g(t,n,r,e-100),o=p(u,100,c);return r<t?o:360-o}(i,y,v,f,a.segmentLength),x:m(i,v,x),y:m(y,f,x)}},r.remove=function(r){return b(u,r)},r.reverse=function(r){return b(c,t(r))},r.rotate=function(r,e){var t=A(r).center;return b(o,r,e,t)},r.scale=function(r,e,t){var n=2<arguments.length&&void 0!==t?t:"center",u=A(r),c=u.bottom,o=u.center,a=u.left,i=u.right,y=u.top,v=o.x,f=o.y;switch(n){case"topLeft":v=a,f=y;break;case"topRight":v=i,f=y;break;case"bottomRight":v=i,f=c;break;case"bottomLeft":v=a,f=c}return b(function(r){return r.map(function(r){return function(r,e,t,n){var u=s({},r);return u.x=t-(t-u.x)*e,u.y=n-(n-u.y)*e,r.curve&&(u.curve=s({},u.curve),"arc"===u.curve.type?(u.curve.rx&&(u.curve.rx=u.curve.rx*e),u.curve.ry&&(u.curve.ry=u.curve.ry*e)):(u.curve.x1=t-(t-u.curve.x1)*e,u.curve.y1=n-(n-u.curve.y1)*e,"cubic"===u.curve.type&&(u.curve.x2=t-(t-u.curve.x2)*e,u.curve.y2=n-(n-u.curve.y2)*e))),u}(r,e,v,f)})},r)},Object.defineProperty(r,"__esModule",{value:!0})});
